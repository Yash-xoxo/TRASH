# 1) Ensure required tools are installed
apt update
apt install -y curl gnupg ca-certificates

# 2) Create keyrings dir (idempotent)
mkdir -p --mode=0755 /usr/share/keyrings

# 3) Download Cloudflare's signed key and dearmor it into the keyrings dir
curl -fsSL https://pkg.cloudflare.com/cloudflare-main.gpg | gpg --dearmor -o /usr/share/keyrings/cloudflare-main.gpg

# (If your existing commands used cloudflare-public-v2.gpg, you can also fetch that name:)
# curl -fsSL https://pkg.cloudflare.com/cloudflare-public-v2.gpg | gpg --dearmor -o /usr/share/keyrings/cloudflare-public-v2.gpg

# 4) Add Cloudflare's apt repository (replace 'jammy' with your release codename if different)
echo 'deb [signed-by=/usr/share/keyrings/cloudflare-main.gpg] https://pkg.cloudflare.com/cloudflared jammy main' \
  | tee /etc/apt/sources.list.d/cloudflared.list

# 5) Update & install cloudflared
apt update
apt install -y cloudflared

# 6) Verify
cloudflared --version






apt update
apt install -y python3 python3-venv python3-pip
# Create environment
python3 -m venv /opt/appenv
source /opt/appenv/bin/activate


python3 - << 'EOF'
import numpy, pandas, cv2, torch, streamlit
print("Environment online.")
EOF


lvremove /dev/pve/data -y
lvresize -l +100%FREE /dev/pve/root
resize2fs /dev/mapper/pve-root
